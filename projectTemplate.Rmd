---
output:
  html_document: default
  pdf_document: default
---
EDA with White wine Quality Dataset by VISHAL VIKRAM SINGH
========================================================

INTRODUCTION

This dataset is related to the white wine of Portuguese version of "Vinho Verde".Here we will apply Exploratory data analysis in order to find out any influence of the chemical properties of wine over the quality of wine which is ranked from 0(very bad) to 9 (very good).

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(gridExtra)
library(dplyr)
library(corrplot)
```
Summary of Data 
```{r echo=FALSE, Load_the_Data}

wine<-read.csv("wineQualityWhites.csv")
dim(wine)


```
Our dataframe consist of 4896 rows and 13 columns.
```{r echo=FALSE,message=FALSE,warning=FALSE}
str(wine)
```

```{r echo=FALSE,message=FALSE,warning=FALSE}
summary(wine)
```

We can observe that median quality of wine is 6 which means 50% of wines are rated more than 6 on the scale of 0 to 9 .It can also be observed that minimum value of citric acid is 0 , which means some wines have no citric Acid. It can also be inferred that some wines have high total sulphur dioxide content.


DISTRIBUTION OF SINGLE VARIABLES

1.QUALITY

```{r echo=FALSE, Univariate_Plots}

ggplot(aes(x=quality),data = wine)+geom_bar(fill="orange")+
  scale_x_continuous(breaks = c(3,4,5,6,7,8,9))
```

We can see that most of the wines are of quality rating 6. Very small number of wines are rated 9. We have very small top quality rated wines in the dataset.

2.ALCOHOL

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x=alcohol),data=wine)+geom_histogram(fill="orange",binwidth =0.30)+
  scale_x_continuous(breaks = seq(8,15,0.50))

```

It can be observed that there is peak around 9.3 . The distribution is roughly normal.

3.RESIDUAL SUGAR 

```{r echo=FALSE,warning=FALSE}
ggplot(aes(x=(residual.sugar)),data=wine)+geom_histogram(fill="orange",binwidth = 0.1)+
  xlim(0,quantile(wine$residual.sugar,0.99))
```

Here we can see that distribution of residual sugar across the wine dataset is skewed . We can apply some transformations to investigate it further.

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x=(residual.sugar)),data=wine)+geom_histogram(fill="orange",binwidth = 0.04)+
  xlim(0,quantile(wine$residual.sugar,0.99))+
  scale_x_log10()
```

After transfromation and removing outlies it can be observed that quantity of residual sugar roughly follows a bimodal distibution .

4.CITRIC ACID

```{r echo=FALSE,warning=FALSE}
ggplot(aes(citric.acid),data=wine)+ geom_histogram(fill="orange",binwidth = 0.05)+
  xlim(0,quantile(wine$citric.acid,0.99))

```


Again ,its observed that distribution of citric acid follows normal distribution with peaking around 0.3 .

5.VOLATILE ACIDITY

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x=volatile.acidity),data=wine)+ geom_histogram(fill="orange",binwidth = 0.025)+
  scale_x_continuous(breaks = seq(0.1,1,0.05))
```

Distribution of citric acid follows the normal distribution curve . Volatile Acidity of a wine can be related to the aroma of the wine .We can see that majority of wines have some amount of volatile acidity while a few wines have comparatively large volatile acidity indicating that they are more aromatic .

6.FREE SUGAR 

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x=wine$free.sulfur.dioxide),data=wine)+geom_histogram(fill="orange",binwidth = 5)+
  xlab("Amount of free sugar in the wine ")+
  xlim(0,150)

```

it also follows the normal distribution .Most of the wines have less than  90 g/l free sugar.

7.DENSITY 

```{r echo=FALSE,warning=FALSE}
ggplot(aes(x=density),data=wine) +geom_histogram(fill="orange",binwidth = 0.0005)+
  scale_x_continuous(limits = c(0.9871,1.0390))


```

Here we can see that most of the wines have density falling between 0.98 to 1 . This distribution also follows the normal distribution curve .

8.FREE SULPHUR DIOXIDE 

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x=free.sulfur.dioxide),data=wine)+geom_histogram(fill="orange",binwidth = 5)+
  xlim(0,150)
```

Most of the wine contains less than 50 mg/dm^3 . Again the distribution is Normal.

UNIVARIATE ANALYSIS

Q.What is the structure of your dataset ?

There are 4986 white wines in the dataset with 12 features.The following observations can be made after doing some plottig:
1.Most of the wines have rating of 6 .
2.the median alcohol quantity is 10.40 .
3. Some wines in the dataset have  zero citric Acid .

Q.What are the main features of interest in your dataset ?

the main feature of interest in our dataset is alcohol and quality .I would like to determine how the quantity of alcohol in the wine affects its quality .

Q.What other features in the dataset do you think will help  support your investigation into your feature of interest ?

I think other features like pH , citirc Acid , free sugar would also affect the quality of the wine .

Q.Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?

I log transformed the skewed- distribution of residual sugar to get more even distribution of the data. After transformation bimodal curve is obtained .I also removed some outliers from the data before applying transformation.


BIVARIATE PLOTTING

1.CORRELATION MATRIX 

```{r echo=FALSE,warning=FALSE}
cor(wine)

```

```{r echo=FALSE, echo=FALSE, warning=FALSE}
wine<-read.csv("wineQualityWhites.csv")
library(corrplot)
corrplot(cor(wine))


```


From the coorelation matrix plot we can see that quality and alcohol have comapratively strong value of pearsons r .We will further investigae it by plotting them against each other.I have plotted some other variables of interest in the following section:

2.QUALITY VS ALCOHOL


```{r echo=FALSE,Bivariate_Plots}
ggplot(aes(x=alcohol, y=quality,color=quality),data=wine)+geom_point(alpha=1/14, position = "jitter")

```

As we can see that as quality increase alcohol content also increase .


3. QUALITY VS VOLATILE ACIDITY 

```{r echo=FALSE,warning=FALSE}
ggplot(aes(x=volatile.acidity, y=quality,color=quality),data=wine)+geom_point(alpha=1/5, position = "jitter")

```

Here we can see that wine with higher quality rating tend to have smaller volatile Acidity .


4. QUALITY VS DENSITY 

```{r echo=FALSE, warning=FALSE}
ggplot(aes(x=density, y=quality,color=quality),data=wine)+geom_point(alpha=1/5, position = "jitter")


```

Again there appears to be some relationship between density and qualty as higher quality wine tend to have comparatively lower density .Although it was not our main feature of interest but after plotting the correlation matrix we saw some evidence of this relationship.





# Bivariate Analysis

From the coorelation matrix it is evident that quality and alcohol have strong relationship as compared to other variables. This strengthened out assumption .After plotting alcohol vs quality on scatterplot we can cearly see some trends.Higher quality wines tend to have higher alcohol quantity.

I also observed some interesting relationship between qualty and density  which was not part of our initial assumption. Volatile acidity and quality also  showed some negative relationship.

The strongest relationship i found was between alcohol and quality.




MULTIVARIATE PLOTs

1.ALCOHOL VS VOLATILE ACIDITY AND QUALTY 

```{r echo=FALSE, Multivariate_Plots}
wine$quality <- ordered(wine$quality, levels = c(3, 4, 5, 6, 7, 8,9))

library(RColorBrewer)
myColors <- brewer.pal(7,"Set1")
names(myColors) <- levels(wine$quality)
colScale <- scale_colour_manual(name = "quality",values = myColors)

ggplot(aes(x = alcohol, y = volatile.acidity),
       data = wine) +
  geom_point(aes(color = quality)) +
  colScale  

```

Here we can observe that wine with higer quality rating tends to have higher alcohol percentage and lesser volatile Acidity .

2.ALCOHOL VS DENSITY AND QUALITY AS COLOR 

```{r echo=FALSE,warning=FALSE}

library(RColorBrewer)
myColors <- brewer.pal(7,"Set1")
names(myColors) <- levels(wine$quality)
colScale <- scale_colour_manual(name = "quality",values = myColors)

ggplot(aes(x = alcohol, y = density),
       data = wine) +
  geom_point(aes(color = quality)) +
  colScale


```

Here again we can see that wine with higher rating tends to have lower density and higher alcohol content.





FINAL PLOTS AND SUMMARY 

PLOT ONE

```{r echo=FALSE,warning=FALSE,Plot_One}

ggplot(aes(x=quality),data = wine)+geom_bar(fill="orange")
```


Above plot shows the distribution of observations from dataset  across different quality parameter ranked by the experts.We can see that most of the wines have quality rating of 6.


PLOT TWO

```{r echo=FALSE,warning=FALSE}
wine<-read.csv("wineQualityWhites.csv")
library(corrplot)
corrplot(cor(wine))

```


Above plot shows the correlation coefficient  between each pair of attributes.It can be observed that quality has high correlation coefficient with alcohol.


PLOT THREE

```{r echo=FALSE, Plot_Three}
wine$quality <- ordered(wine$quality, levels = c(3, 4, 5, 6, 7, 8,9))

library(RColorBrewer)
myColors <- brewer.pal(7,"Set1")
names(myColors) <- levels(wine$quality)
colScale <- scale_colour_manual(name = "quality",values = myColors)

ggplot(aes(x = alcohol, y = volatile.acidity),
       data = wine) +
  geom_point(aes(color = quality)) +
  colScale  

```

Our final plot represents that higher quality wines have high alcohol content and lesser volatile acidity.



REFLECTION

From exploratory data analysis of white wine quality dataset it can be inferred that higher quality wine tends to have higher alcohol content . As per our assumption i find out the relationship between quality and alcohol content. I also found that higher quality wines have lesser density as compared to lower quality wines. So density and alcohol content is the crucial factor in order to make good wines.
